The paywith.glass team objectives for the Odyssey 2019 Hackathon are:
1. The definition of the first Public REST API rules for the paywith.glass platform (v0.1)
2. The release of the initial documentation for this API
3. An example of the API in use via a demonstration of how a mobile application can make use of this API to communicate
with the platform.

================================================================================================================================

Section 1: The REST API
-----------------------

DESCRIPTION
-----------
paywith.glass uses a simple http REST API whereby calls go to the following address on port 443 (https):
  https://txn.paywith.glass
  
All calls are prefixed with the following php POST/GET parameters:
  v=$VENDOR_DOMAIN_NAME
  cc=$VENDOR_COUNTRY_ID
  o=$USER_ID_HASH
  
  eg - https://txn.paywith.glass/?v=$VENDOR_DOMAIN_NAME&cc=$VENDOR_COUNTRY_ID&o=$USER_ID_HASH

All calls must include identification of:
    1. The vendor via a unique domain name "$VENDOR_DOMAIN_NAME" (default is paywith.glass/smdwireless.com)
    2. The country code of the vendor under which the account falls "$VENDOR_COUNTRY_ID" (default is uk-uk,+00/amsterdam-nl,+02)
    3. The user account that is accessing the service under that vendor identified by PHP Session ID "$USER_ID_HASH".

User identification will be achieved via our looking.glass authentication infrastructure which defines these rules in way that
has already been standardized across our entire ecosystem.

looking.glass authentication relies on the user's php session id. If a user connects to the service with session ID that is recognized as being owned by a guest user, the default action returns the looking.glass login form.

Failure to present recognizable inputs for any of the prefix parameters result in a 301 redirection to https://paywith.glass.





LIST of accepted $VENDOR_COUNTRY_ID codes by country:
Country name                    Vendor Country ID

Antigua & Barbuda               antigua-ag,-04
Australia                       sidney-au,+10
Barbados                        barbados-bb,-04
Belgium                         brussels-be,+02
Belize                          belize-bz,-06
Canada                          toronto-ca,-04
Dominica                        dominica-dm,-04
France                          paris-fr,+01
Germany                         berlin-de,+02
Ghana                           accra-gh,+00
Grenada                         grenada-gd,-04
Guyana                          guyana-gy,-04
Ireland                         ireland-ie,+00
Jamaica                         jamaica-jm,-05
New Zealand                     auckland-nz,+12
Nigeria                         lagos-ng,+01
South Africa                    johannesburg-za,+02
Spain                           madrid-es,+02
St. Vincent & the Grenadines    stvincent-vc,-04
St. Lucia                       stlucia-lc,-04
St. Kitts & Nevis               stkitts-kn,-04
Taiwan                          taipei-tw,+08
The Netherlands                 amsterdam-nl,+02
Trinidad & Tobago               trinidad-tt,-04
United Kingdom                  uk-uk,+00


ENDPOINT CODE BASE
------------------

<?php
   $VENDOR_DOMAIN_NAME = false;
   $VENDOR_COUNTRY_ID = false;
   $USER_ID_HASH = false;
 
  foreach (getallheaders() as $headerkey => $headervalue) {
    if ($headerkey == 'v') {
      $VENDOR_DOMAIN_NAME = $headervalue;
      }
    elseif ($headerkey == 'cc') {
      $VENDOR_COUNTRY_ID =  $headervalue;
      }
    elseif ($headerkey == 'o') {
      $USER_ID_HASH = $headervalue;
      }
    }


if ( $VENDOR_DOMAIN_NAME && $VENDOR_COUNTRY_ID && $USER_ID_HASH ) {

        // Look up $VENDOR_DOMAIN_NAME and $VENDOR_COUNTRY_ID in db to determine the include file that should be loaded
        // Check if the user is logged in or not. If logged in, present mobile application template from appropriate
        // country then fetch requested data.
        
        // If not logged in, fetch login-page for the matched region.

        die();
        }

else {
        header("Location: https://paywith.glass");
        }

?>

